# NULL

Unterlagen auf http://griesmayer.com/?menu=Oracle&semester=Semester_5&topic=03_NULL

```sql
CREATE TABLE PATIENT (
	PATIENT_ID INTEGER PRIMARY KEY,
	NAME       VARCHAR2(100) NOT NULL,
	HEALTHY    CHAR(1),
	INVESTIGATIONS INTEGER,
	OPERATIONS     INTEGER,
	DISEASES       INTEGER
);

CREATE TABLE DISEASES_CLASS (
    NUMBEROF INTEGER,
    CONDITION VARCHAR2(20)
);



INSERT INTO PATIENT VALUES (1, 'Hans',   'Y',   NULL, 0,    3);
INSERT INTO PATIENT VALUES (2, 'Werner', NULL,  2,    2,    2);
INSERT INTO PATIENT VALUES (3, 'Thomas', 'N',   0,    0,    NULL);
INSERT INTO PATIENT VALUES (4, 'Susi',   'N',   NULL, 2,    2);
INSERT INTO PATIENT VALUES (5, 'Alex',   NULL,  1,    NULL, NULL);
INSERT INTO PATIENT VALUES (6, 'Kurt',   'Y',   2,    NULL, 1);
INSERT INTO PATIENT VALUES (7, 'Max',    'Y',   NULL, NULL, NULL);
COMMIT;

INSERT INTO DISEASES_CLASS VALUES (NULL, 'NOT APPLICABLE');
INSERT INTO DISEASES_CLASS VALUES (0, 'GOOD');
INSERT INTO DISEASES_CLASS VALUES (1, 'OK');
INSERT INTO DISEASES_CLASS VALUES (2, 'POOR');
INSERT INTO DISEASES_CLASS VALUES (3, 'BAD');
INSERT INTO DISEASES_CLASS VALUES (4, 'VERY BAD');
COMMIT;

-- NULL im Kriterium
-- Wie viele Personen sind gesund (3)?
SELECT *
FROM PATIENT
WHERE HEALTHY = 'Y';

-- Wie viele Personen sind nicht gesund?
SELECT *
FROM PATIENT
WHERE HEALTHY = 'N';
-- Unterscheidet sich von voriger Abfrage, denn wir wollen auch unbekannte
-- Daten.
SELECT *
FROM PATIENT
WHERE HEALTHY IS NULL OR HEALTHY = 'N';
-- Alternativ
SELECT *
FROM PATIENT
WHERE COALESCE(HEALTHY, 'N') = 'N';

-- Wie viele Werte sind in Healthy, wie viele sind ungleich NULL?
SELECT COUNT(*), COUNT(HEALTHY), COUNT(*) - COUNT(HEALTHY) AS IstNull
FROM PATIENT;

-- NULL in der Berechnung
SELECT PATIENT_ID, DISEASES, OPERATIONS, 
    DISEASES + 1, 
    DISEASES - OPERATIONS,
    0 * DISEASES
FROM PATIENT;

-- NULL in Gruppenfunktionen wird ignoriert.
SELECT AVG(DISEASES) AS AvgDiseases, COUNT(DISEASES) AS CountDiseases
FROM PATIENT;

-- NULL im JOIN
SELECT *
FROM PATIENT INNER JOIN DISEASES_CLASS ON (DISEASES = NUMBEROF);
-- NULL mit COALESCE
SELECT *
FROM PATIENT INNER JOIN DISEASES_CLASS ON (COALESCE(DISEASES,-1) = COALESCE(NUMBEROF,-1))


-- Liefert nur 1 Datensatz mit DISEASES = 1
SELECT * FROM PATIENT WHERE DISEASES IN (SELECT 1 FROM DUAL UNION SELECT NULL FROM DUAL);
-- Liefert keinen Datensatz mit DISEASES = 1
SELECT * FROM PATIENT WHERE DISEASES NOT IN (SELECT 1 FROM DUAL UNION SELECT NULL FROM DUAL);

-- Nach den UPDATE bleibt der Wert NULL erhalten.
UPDATE PATIENT SET DISEASES = DISEASES + 1;
SELECT * FROM PATIENT;

-- Nun ist jeder Wert von DISEASES NULL
UPDATE PATIENT SET DISEASES = DISEASES + NULL;
SELECT * FROM PATIENT;

-- NULL in der Stringverknüpfung
SELECT 'Hello' || 'World'
FROM DUAL;
SELECT 'Hello' || null
FROM DUAL;
```
